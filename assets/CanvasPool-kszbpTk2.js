import{g as x,B as p}from"./colorToUniform-CDYLUI2Q.js";import{T as C,D as d,n as u}from"./index-BRTvXtaW.js";const v={};function _(n,e){let t=2166136261;for(let a=0;a<e;a++)t^=n[a].uid,t=Math.imul(t,16777619),t>>>=0;return v[t]||h(n,e,t)}let r=0;function h(n,e,t){const a={};let s=0;r||(r=x());for(let c=0;c<r;c++){const l=c<e?n[c]:C.EMPTY.source;a[s++]=l.source,a[s++]=l.style}const o=new p(a);return v[t]=o,o}class i{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,t){const a=d.get().createCanvas();a.width=e,a.height=t;const s=a.getContext("2d");return{canvas:a,context:s}}getOptimalCanvasAndContext(e,t,a=1){e=Math.ceil(e*a-1e-6),t=Math.ceil(t*a-1e-6),e=u(e),t=u(t);const s=(e<<17)+(t<<1);this._canvasPool[s]||(this._canvasPool[s]=[]);let o=this._canvasPool[s].pop();return o||(o=this._createCanvasAndContext(e,t)),o}returnCanvasAndContext(e){const t=e.canvas,{width:a,height:s}=t,o=(a<<17)+(s<<1);this._canvasPool[o].push(e)}clear(){this._canvasPool={}}}const B=new i;export{B as C,_ as g};
